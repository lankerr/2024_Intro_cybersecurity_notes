# 协议栈

| 协议栈 | 网络攻击 | 攻击共性特征 | 协议栈的缺陷 | 防御 |
| --- | --- | --- | --- | --- |
| 链路层 | 帧嗅探 <br> ARP污染 | ①攻击者进行身份欺骗，伪装成原通信会话的合法参与方<br>②攻击者伪造请求，并观测、判断目标对请求的响应，推理出受害通信会话的状态信息<br>③攻击者依据推理出的会话状态信息，伪造可被原会话接受的数据包，注入原合法数据流中，进行恶意攻击 | ①网络地址可伪造<br>②系统随机化程度不够 | ①真实地址与真实身份<br>②网络系统随机化 | |
| 网络层 | IP地址欺骗<br>IPID误用<br>IP分片误用<br>ICMP误用<br>路由劫持 | | | |
| 传输层 | TCP劫持<br>TCP DoS | | | |

![image](/image/common_attack.png)

这个东西整体是比较提纲挈领的
# 链路层功能
1. 成帧
2. 透明传输
3. 差错检测
4. 数据链路

如果有恶意的，我们会使用恶意的ARP表进行映射
# ARP欺骗
不仅可以获取别人的数据，甚至可以篡改数据

# 网络嗅探

嗅探所使用的工具称为“嗅探工具”，也称为“数据包分析器”，还有别称为“嗅探器”、“抓包工具”等。常见的开源嗅探工具包括TCPDUMP，WIRESHARK等

恶意的网络嗅探，取决于攻击者的位置和攻击能力：
共享网络传输链路场景下，攻击者的恶意嗅探监听
攻击者控守了网络设备，对流经的流量进行拦截嗅探

# 网络层
主要功能很多
分组与分组交换
路由
网络互联
网络连接复用
差错检测与恢复
服务选择
网络管理
分片与重组

网络层的源IP地址假冒攻击（IP spoofing），是最常见的一种针对IP协议的攻击
![image](/image/IP_attack.png)

# 防御1:IPSec协议
IPSec的两种工作模式：
传输（transport）模式：只是传输层数据被用来计算AH或ESP头，AH或ESP头以及ESP加密的用户数据被放置在原IP包头后面

隧道（tunnel）模式：用户的整个IP数据包被用来计算AH或ESP头，AH或ESP头以及ESP加密的用户数据被封装在一个新的IP数据包中

# 路由
路由（routing）是通过互联的网络，把信息从源地址传输到目的地址的活动。路由发生在TCP/IP协议的第三层即网络层。路由引导分组转送，经过一些中间的节点后，到它们最后的目的地

比较简单的是域内路由和域间路由
# 域间路由安全
BGP 劫持成功，恶意攻击者的宣告必须满足以下条件：

（1）宣告比以前其他 AS 更具体的 IP 地址范围
（2）提供一条通往目标IP 地址块的较短路径

# 一个有趣的案例
巴基斯坦电信管理局将YouTube“列入了黑洞”(即创建一条路径，以便将访问YouTube的浏览器请求转到“空路由”而不是转到YouTube)。 因此，当巴基斯坦的用户使用浏览器访问YouTube时，新的路由信息将用来把浏览器转到这条空路由。这也正是巴基斯坦想要达到的目的。遗憾的是，巴基斯坦方面随后将该路由发送到它们的国际数据运营商香港电讯盈科(PCCW)。让问题更复杂的是，电讯盈科是全球20大数据运营商之一，所以它们的路由表被一路推送给全球各地的其他运营商。
