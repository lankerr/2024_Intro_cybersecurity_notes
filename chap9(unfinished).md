# DNS安全
攻击面	攻击类型	共性特征	DNS缺陷	防御策略
本地DNS
服务器	缓存中毒攻击	①攻击者利用嗅探或推测等方式伪造DNS应答，欺骗服务器采信
②攻击者利用域名系统存在的复杂解析依赖，寻找解析环节配置错误，发起攻击
③攻击者大量消耗系统资源	①协议设计缺乏验证及加密机制
②系统缺乏严格管理机制
③服务器缺乏分布式部署等保护措施	①建立支持验证及加密能力的基础设施
②健全域名系统管理机制
③部署服务器保护措施
互联网DNS
服务器	来自恶意DNS服务器的回复伪造攻击
本地/互联网DNS服务器	拒绝服务攻击

# DNS的演进
注意，人类记忆的叫做域名，计算机记忆的叫做IP地址。DNS就是将域名转换为IP地址的服务。
1983年以前，互联网上的每台计算机都有一个静态的主机文件，里面记录了域名和IP地址的对应关系。这种方式不适合互联网的快速发展，因此诞生了DNS。
1983年，Paul Mockapetris设计了DNS，将域名和IP地址的对应关系存储在分布式数据库中，这样就可以动态地添加、删除和修改域名和IP地址的对应关系。
DNS的工作原理：DNS服务器将域名解析为IP地址，然后将IP地址返回给客户端。
域名系统采用层级树形结构，最顶层为根(Root)，根下面是顶级域名(Top-Level Domain, TLD)，TLD下面是二级域名(Second-Level Domain)，二级域名下面是三级域名(Third-Level Domain)，以此类推。

# DNS使用及解析过程
1.  浏览器输入域名
2.  请求到达DNS解析程序
3.  查询获得IP地址
4. 返回IP至Web浏览器
5. 访问IP地址
6. 浏览器显示该页面

DNS攻击:
1. 缓存中毒攻击
缓存中毒是指利用本地DNS服务器的缓存机制，将被篡改的虚假信息缓存到本地DNS 服务器，达到持续造成危害的目的
伪造DNS回复，攻击者需要知道请求中的一些参数，如UDP源端口号、请求交易ID、请求问题等。由于UDP包没有加密，攻击者可以在局域网直接捕获
这个是放到本地的服务器上面
远程缓存中毒攻击难点：
由于不能嗅探DNS请求，很难获取DNS请求中的两个数据：一是UDP的头部端口号，DNS请求通过UDP发送，源端口号是16bit的随机数字，二是DNS头部的16bit交易ID。由于不能嗅探，远程攻击者猜测准确的概率为1/2^32，即便远程攻击者用上千台主机发起攻击，成功猜测的时间也远远超过了本地DNS服务器得到真实回答并存入缓存的时间
为了克服约束，就有了Kaminsky Attack这种攻击方法。Kaminsky的主要技术是绕开TTL的约束，使得攻击具有较高的成功率。

2. 恶意DNS服务器伪造
3. 拒绝服务器攻击


