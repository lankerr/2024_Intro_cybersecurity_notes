# 公钥
公钥基础设施PKI(Public Key Infrastructure)
前面章节我们也看到了，IP地址伪造是非常容易的，由此也带来了各种安全风险。所以我们需要一种能够在互联网上确认身份的机制，特别用户需要准确确认服务器是否真实，尤其是用户需要访问网上银行进行涉及财产安全的操作时，更需要确认正在访问的网站是否是真实的网上银行。
和身份证机制类似，如果存在第三方权威机构，它负责给网络实体颁发身份证明书，在通信时验证身份证明书便可以确认对方的身份了，并且这个权威机构还必须是大家都可以信赖的，能将用户所持有的公开密钥与其身份信息结合在一起，当然用户也要好好保管自己的身份证明书。这个权威机构就是我们常说的CA（Certificate Authority），而整个体系就是公钥基础设施PKI（Public Key Infrastructure）
我们主要会考虑这两个小问题:
1. 认证机关是否可信？
2. 证书颁发与维护过程是否存在风险？

# 证书
1.现实中的证书是拥有唯一编号的凭证
2.在PKI体系中，证书是一个非常关键的存在，下面我们就稍微详细地介绍一下证书。证书（Certificate），有时候简称为cert，是一个经证书授权中心数字签名的、包含公开密钥拥有者信息以及公开密钥的文件。通过证书可以向系统中的其他实体证明自己的身份，也可通过证书进行公钥分发。

# 数字证书 
CA认证中心，主体将身份信息和公钥用安全的方式提交给CA认证中心，CA用自己的私钥进行加密，生成公钥，身份ID和CA签名三部分组成的证书我国目前有40多家CA，然后是RA注册中心RA负责系统证书申请者的录入

# 利用数字证书进行加密
① 甲方准备好要传送给乙方的信息（明文）
② 甲获取乙的数字证书，并验证该证书有效后，用乙方证书中的公钥加密信息（密文）
③ 乙方收到加密的信息后，用自己证书对应的私钥解密密文，得到明文信息
注意，甲方使用乙方的加密！

# 利用数字证书进行签名

① 甲方准备好要传送给乙方的信息（明文）
② 甲计算该信息的消息摘要
③ 甲用自己证书对应私钥对消息摘要加密得到数字签名，并将其附在信息后
④ 甲方将附带有数字签名的信息传送给乙方
⑤ 乙方验证甲方数字证书后用证书中的公钥解密数字签名 

注意，甲要使用摘要和私钥得到签名，
明文数据量很大时可以结合数字信封的方式加密，注意甲需要知道公钥，并且验证了哈希值之后才可以
数字证书有主题身份信息，主体公钥数值和认证机构名字，使用散列可以生成数字签名，注意的是CA使用自己的私钥对主体公钥进行签名

# PKI安全问题的由来
首先是证书的合法性，PKI需要接口系统，提供证书验证以及备份恢复，但是向用户屏蔽细节

# CA的信任关系
信任：如果一个实体假定另一个实体会严格的像它期望的那样行动，就称它信任那个实体。信任包含双方的一种关系以及对该关系的期望
信任水平（信任度）：描述了信任的一方对另一方的信任程度，信任水平高低的情况，可能需要引入第三方。信任总是与风险相联系
信任模型：规定了最初信任的建立，以及它允许对基础结构的安全性以及被这种结构所强加的限制进行更详尽的推理
信任域：是公共控制下或服从于一组公共策略的系统集，策略可以通过明确对顶，也可通过操作过程指定。信任域可以按照组织或地理界限来划分。
信任锚： 信任模型中，直接确定一个身份或通过可信实体签发证明身份，方能作出信任决定。这个可信实称为信任锚。信任锚是信任体系的起点。

# CA的信任模型

单CA信任模型：单CA信任模型是最基本的信任模型，也是目前许多组织或单位在Intranet中普遍使用的一种模型
层次信任模型：层次信任模型也称为分级信任模型，它是一个以主、从CA关系建立的分级PKI结构
分布式信任模型：分布式信任模型也称为网状信任模型，在这种模型中CA间存在着交叉认证
